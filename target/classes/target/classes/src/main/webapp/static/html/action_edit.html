
<div>
    <div role="tabpanel" class="tab-pane fade" ng-class="{true: 'tab-pane fade active in', false: 'tab-pane fade'}[true]" id="action_edit" aria-labelledby="action_edit-tab" ng-if="action_edit_response_data.data" class="col-md-10">
        <br>
        <div class="row">
            <div class="col-md-offset-1 col-md-10 nlu-appmodel-table">
                <div class="alert alert-warning alert-dismissible fade in" role="alert" ng-show="!action_edit_response_data.data.length">
                    <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                    {{slot.intent_name}} 该app下暂无动作，请先进行添加。
                </div>
                <a class="btn btn-info" href="/all/index?appid={{appid}}">返回应用全景</a>
                <div ng-show="action_edit_response_data.data.length">

                    <button class="btn btn-primary" ng-click = "generate_bot_setting()"> 一键生成对话逻辑配置 </button>
                    <button  ng-show="trigger.trigger_list.length!=0" href="" data-toggle="modal" data-target="#model_trigger_effect_description" class="btn btn-danger"> 对话逻辑配置生效</button>
                    <h4>对话session清空设置</h4>
                    <div class="row col-md-offset-1 col-md-offset" id="bot_merge_rule_div">
                        <form class="form-inline" role="form" id="form_bot_merge_rule" style="font-size:15px">
                            <div class="checkbox" style="margin-right:4%">
                                <label>
                                  <input type="checkbox" id="change_intent_clear_session_checkbox"> 切换意图自动清空session
                                </label>
                            </div>
                            <div class="form-group" style="margin-right:4%">
                                <div class="input-group" >
                                  <input class="form-control" type="text" id="interaction_round_value" placeholder="" style="width: 70px;text-align: right;">
                                  <div class="input-group-addon">轮之前的session都清空(-1表示不清空)</div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-primary" ng-click="bot_session_update_set()" id="bot_session_update_set_btn">保存设置</button>
                            <span class="label label-success" id="session_set_save_info" style="display:none">保存成功</span>

                        </form>
                    </div>
                <div class="modal fade" id="model_trigger_effect_description" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <h4 class="modal-title" id="myModalLabel">填入描述信息</h4>
                            </div>
                            <div class="modal-body">
                                <br>
                                <form class="form-horizontal" role="form" id="form_train_all_description">
                                    <div class="form-group">
                                    <label for="query"  class="col-sm-3 control-label">描述信息</label>
                                        <div class="col-sm-9">
                                     <!--        <textarea ng-model="description" value="{{description}}" id="input_description" cols="50" rows="7"></textarea> -->
                                             <textarea  id="input_description_trigger_effect" cols="50" rows="7" ng-maxlength="50" maxlength="50">{{time}}</textarea>
                                    <!--         <input  style="height: 80px" type="text" class="form-control" name="file_name_test" > -->
                                        </div>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" ng-click="trigger_effect()">提交</button>
                                    <button type="button" class="btn btn-default" data-dismiss="modal" id="cancel_trigger_effect">取消</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <h4 class="">动作列表 (ACTION)&nbsp;<span id="hint_action_list"  style="font-size: 20px;vertical-align: middle;color: #1ba8ed;" onMouseOver="$(this).tooltip('show')" data-toggle="tooltip" data-placement="right" title="定义一个可执行操作，例如 反问、hint、满足(下单、查数据库)"><icon class="glyphicon glyphicon-question-sign"></icon></span></h4>
                    <table class="table table-condensed table-bordered table-hover">
                        <thead>
                            <th>动作(action)</th>
                           <!--  <th>执行(exe)</th> -->
                        <!--     <th>话术(say)</th> -->
                            <th> 执行或者话术(exe or say)</th>
                            <th>动作类型(act_type)</th>
                      <!--       <th>目标(act target)</th>
                            <th>类型细节(act type detail)</th>
                            <th>目标细节(act target detail)</th> -->
                            <th>操作</th>
                        </thead>
                        <tbody>
                            <tr ng-repeat="action_item in action_edit_response_data['data']">
                                <td style="text-align:left" >
                                    {{action_item.action_name}}
                                </td>
                                <td style="text-align:left"  ng-if="action_item.exe!=''" >
                                    {{action_item.exe}}
                                </td>
                                <td style="text-align:left"  ng-if="action_item.say!=''">
                                    {{action_item.say}}
                                </td>
                                <td style="text-align:left" >
                                    {{action_item.act_type}}
                                </td>
                            <!--     <td>
                                    {{action_item.act_target}}
                                </td>
                                <td>
                                    {{action_item.act_type_detail}}
                                </td>
                                <td>
                                    {{action_item.act_target_detail}}
                                </td> -->
                                <td style="text-align:left"  class="col-md-2">
                                    <div class="slot_up_down" >
                                        <span style="margin-left: 25%" class="glyphicon glyphicon-edit" title="编辑" data-toggle="modal" ng-click="update_drop_list(action_item)" data-target="#edit_action_{{action_item.id}}" id = "edit_action_span_{{action_item.id}}"></span>
                                        <!-- <span class="glyphicon glyphicon-ok-circle" title="验证"></span> -->


                                        <span ng-if="action_item.action_name!='intent_clarify'&&action_item.action_name!='fail_action'" style="margin-left: 25%" class="glyphicon glyphicon-trash" data-toggle="modal"  data-target="#remove_action_{{action_item.id}}" id="span_remove_{{action_item.id}}" title="删除"></span>
                                            <div class="modal fade" id="remove_action_{{action_item.id}}" tabindex="-1" role="dialog" aria-labelledby="span_remove_{{action_item.id}}" aria-hidden="true">
                                            <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                <h4 class="modal-title" id="myModalEdit">确认删除？</h4>

                                                </div>
                                                <div class="modal-footer">
                                                <button type="submit" class="btn btn-primary"  ng-click="
                                                     delete_action(action_item)">删除</button>
                                                  <button type="button" class="btn btn-default" data-dismiss="modal" ng-model="add_action_cancel_model" >取消</button>

                                                </div>
                                                </div>
                                                </div>
                                                </div>
                                        <div class="modal fade" id="edit_action_{{action_item.id}}" tabindex="-1" role="dialog" aria-labelledby="edit_action_span_{{action_item.id}}" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                                        <h4 class="modal-title" id="myModalEdit">编辑动作</h4>
                                                    </div>
                                                    <div class="modal-body">
                                                        <br>
                                                        <form class="form-horizontal" role="form" id="edit_action_form_{{action_item.id}}">
                                                            <div class="form-group">
                                                                <label for="query" class="col-sm-3 control-label">动作名(action name)</label>
                                                                <div  class="col-sm-9">
                                                                    <input disabled="true"  type="text" id="input_action_name_{{action_item.id}}" class="form-control" value="{{action_item.action_name}}" name="" placeholder="">
                                                                </div>
                                                            </div>
                                               <!--              <div class="form-group">
                                                                <label for="query" class="col-sm-3 control-label">exe</label>
                                                                <div class="col-sm-9">
                                                                    <input type="text" id="input_exe_{{action_item.id}}" class="form-control" value="{{action_item.exe}}" name="" placeholder="">
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="query" class="col-sm-3 control-label">话术(say)</label>
                                                                <div class="col-sm-9">
                                                                    <input type="text" id="input_say_{{action_item.id}}" class="form-control" value="{{action_item.say}}" name="" placeholder="">
                                                                </div>
                                                            </div> -->

                                                                       <hr>

                                    <div class="form-group">
                                    <div ng-if="action_item.exe==''" class="form-group">
                                        <label for="query" class="col-sm-3 control-label">执行(exe)</label>
                                        <input  id="action_{{action_item.id}}_exe_radio" ng-click="radio_change('exe',action_item.id)" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label" >
                                        <div class="col-sm-7">
                                            <input disabled="true" type="text" id="input_exe_{{action_item.id}}" class="form-control" value="" name="" placeholder="_或者字符开头，只能包含_、字母和数字">
                                        </div>
                                    </div>

                                      <div ng-if="action_item.exe!=''" class="form-group">
                                        <label for="query" class="col-sm-3 control-label">执行(exe)</label>
                                        <input  checked="true" id="action_{{action_item.id}}_exe_radio" ng-click="radio_change('exe',action_item.id)" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label"  >
                                        <div class="col-sm-7">
                                            <input type="text" id="input_exe_{{action_item.id}}" class="form-control" value="{{action_item.exe}}" name="" placeholder="_或者字符开头，只能包含_、字母和数字">
                                        </div>
                                    </div>
                                     <div style="margin-left: 15%;margin-top: -14px;color: red">
                                    <label>或者</label>
                                    </div>


                                    <div ng-if="action_item.say==''" class="form-group">
                                        <label for="query" class="col-sm-3 control-label">话术(say)</label>
                                        <input id="action_{{action_item.id}}_say_radio" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label"  ng-click="radio_change('say',action_item.id)">
                                        <div class="col-sm-7">
                                            <input disabled="true" type="text" id="input_say_{{action_item.id}}" class="form-control" value="" name="" placeholder="">
                                        </div>
                                    </div>


                                    <div ng-if="action_item.say!=''" class="form-group">
                                        <label for="query" class="col-sm-3 control-label">话术(say)</label>
                                        <input checked="true" id="action_{{action_item.id}}_say_radio" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label"  ng-click="radio_change('say',action_item.id)">
                                        <div class="col-sm-7">
                                            <textarea id="input_say_{{action_item.id}}" class="form-control"  name="" placeholder=""> {{action_item.say}}</textarea>
                                        </div>
                                    </div>
                                    <div id = "slots_div_{{action_item.id}}" class="form-group" ng-show="slot_list.length !=0 && action_item.say!=''">
                                    <label for="query" class="col-sm-3 control-label"><span >插</span><span style="color: transparent;" >对齐</span>入<br>槽位词典</label>
                                        <div  class="col-sm-7 col-sm-offset-1">
                                        <button  ng-repeat="slot in action_slot_list" ng-click="add_slot('input_say_' + action_item.id,slot.slot_name)" style="margin-top: 2%; margin-right: 3px;float: left;" class="btn btn-xs btn-default " class="btn-xs">{{slot.slot_name}}</button>


                                        </div>
                                    </div>
                                    </div>
                                    <hr>
                                                            <div class="form-group">
                                                                <label for="intent" class="col-sm-3 control-label">动作类型(act_type)</label>
                                                                <div class="col-sm-9">
                                                                    <select id="select_action_type_{{action_item.id}}" class="form-control" placeholder="" name="func_slot">
                                                                        <option ng-repeat="action_type in action_edit_drop_list.act_type" ng-if="action_type==action_item.act_type" selected="true" value="{{action_type}}">{{action_type}}
                                                                        </option>
                                                                        <option ng-repeat="action_type in action_edit_drop_list.act_type" ng-if="action_type!=action_item.act_type" value="{{action_type}}">{{action_type}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                <button  disabled="" id = "zhedie_button" style="float: left;" class="btn btn-default btn-xs " data-toggle="collapse"
        data-target="#demo">
        高级选项（待开放）
                                </button>
                                <br>
                                <br>

                                <div id="demo" class="collapse">
                                                            <div class="form-group">
                                                                <label for="intent" class="col-sm-3 control-label">目标(act_target)</label>
                                                                <div class="col-sm-9">
                                                                    <select id="select_action_target_{{action_item.id}}" class="form-control" name="func_slot" ng-model="model_select_action_target" ng-init="model_select_action_target=action_item.act_target" ng-change="action_edit_change(action_item)">
                                                                        <option ng-repeat="action_target in action_edit_drop_list.act_target" ng-if="action_item.act_target==action_target" selected="true" value="{{action_target}}">{{action_target}}
                                                                        </option>
                                                                        <option ng-repeat="action_target  in action_edit_drop_list.act_target" ng-if="action_item.act_target!=action_target" value="{{action_target}}">{{action_target}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>

                                                            <div class="form-group">
                                                                <label for="intent" class="col-sm-3 control-label">类型细节(act type detail)</label>
                                                                <div class="col-sm-9">
                                                                    <select disabled="true" id="select_action_type_detail_{{action_item.id}}" class="form-control" placeholder="" name="func_slot">
                                                                        <option ng-repeat="action_type_detail  in action_edit_drop_list.act_type_detail" ng-if="action_item.act_type_detail ==action_type_detail" selected="true" value="{{action_type_detail}}">{{action_type_detail}}
                                                                        </option>
                                                                        <option ng-repeat="action_type_detail  in action_edit_drop_list.act_type_detail" ng-if="action_item.act_type_detail !=action_type_detail" value="{{action_type_detail}}">{{action_type_detail}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div  style="display:none" class="form-group" id="drop_list_div_{{action_item.id}}">
                                                                <label for="intent" class="col-sm-3 control-label">目标细节(act target detail)</label>
                                                                <div class="col-sm-9">
                                                                    <select id="select_action_target_detail_{{action_item.id}}" class="form-control" placeholder="" name="func_slot">
                                                                        <option ng-repeat="action_target_detail  in action_edit_drop_list.act_target_detail" ng-if="action_item.act_target_detail==action_target_detail" selected="true" value="{{action_target_detail}}">{{action_target_detail}}
                                                                        </option>
                                                                        <option ng-repeat="action_target_detail  in action_edit_drop_list.act_target_detail" ng-if="action_item.act_target_detail!=action_target_detail" value="{{action_target_detail}}">{{action_target_detail}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                              <div  style="display:none" class="form-group" id="check_box_div_{{action_item.id}}">
                                                                <label for="intent" class="col-sm-3 control-label">目标细节(act target detail)</label>
                                                                <div class="col-sm-9">
                                                                    <select id="select_action_target_detail_slot_{{action_item.id}}" class="form-control" placeholder="" name="func_slot">
                                                                        <option ng-repeat="action_target_detail in action_edit_drop_list.slot_list" ng-if="action_item.act_target_detail==action_target_detail.slot_name" selected="true" value="{{action_target_detail.slot_name}}">{{action_target_detail.slot_name}}
                                                                        </option>
                                                                        <option ng-repeat="action_target_detail in action_edit_drop_list.slot_list" ng-if="action_item.act_target_detail!=action_target_detail" value="{{action_target_detail.slot_name}}">{{action_target_detail.slot_name}}
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            </div>
                                                   <!--          <div style="display:none" class="form-group" id="check_box_div_{{action_item.id}}">
                                                                <label for="intent" class="col-sm-3 control-label">act target detail</label>
                                                                <label ng-repeat=" action_target_detail in action_edit_drop_list.slot_list">
                                                                    <input style="margin-left: 10px" type="checkbox" id="check_box_action_target_detail_{{action_item.id}}_{{action_target_detail.slot_name}}" ng-model="role_action"> {{action_target_detail.slot_name}}
                                                                </label>
                                                            </div> -->
                                                          <!--   <div class="form-group">
                                                                <label for="intent" class="col-sm-3 control-label">下个动作</label>
                                                                <div class="col-sm-9">
                                                                    <table class="table table-bordered query-slot-table" id="slot_table">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>return code</th>
                                                                                <th> 下一个action</th>
                                                                                <th>删除</th>

                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tbody_next_action_{{action_item.id}}">
                                                                            <tr class="query-slot-tr copyTr" id="copyTr" style="display:none;">
                                                                                <td>
                                                                                    <input type="text" class="form-control" value="" name="" placeholder="输入return code">
                                                                                </td>
                                                                                <td>
                                                                                    <select class="form-control" placeholder="" name="func_slot">
                                                                                        <option ng-repeat="next_action  in action_edit_drop_list.action_list" name="{{next_action.action_name}}" value="{{next_action.id}}&{{next_action.action_name}}">{{next_action.action_name}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>

                                                                                <td>
                                                                                    <button type="button" class="btn btn-danger btn-xs" onclick="action_delete(this)">
                                                                                        <span class="glyphicon glyphicon-trash"></span>删除
                                                                                    </button>
                                                                                </td>
                                                                            </tr>
                                                                            <tr ng-repeat="return_item in action_item.next_action_list">
                                                                                <td>
                                                                                    <input type="text" class="form-control" value="{{return_item.return_code}}" name="" placeholder="输入return code">
                                                                                </td>
                                                                                <td>
                                                                                    <select class="form-control" placeholder="" name="func_slot">
                                                                                        <option ng-repeat="next_action  in action_edit_drop_list.action_list" ng-if="next_action.id==return_item.next_action_id" selected="true" value="{{next_action.id}}&{{next_action.action_name}}">{{next_action.action_name}}
                                                                                        </option>
                                                                                        <option ng-repeat="next_action in action_edit_drop_list.action_list" ng-if="next_action.id!=return_item.next_action_id" value="{{next_action.id}}&{{next_action.action_name}}">{{next_action.action_name}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td>
                                                                                    <button type="button" class="btn btn-danger btn-xs" onclick="action_delete(this)">
                                                                                        <span class="glyphicon glyphicon-trash"></span>删除
                                                                                    </button>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div> -->
                                                <!--             <span ng-model="add_next_action" ng-click="add_action_return_code(action_item.id)" style="color:#00FF004;width: 20px;height: 20px;float: ;" class="glyphicon glyphicon-plus"></span> -->
                                                        </form>
                                                        <div class="modal-footer">
                                                            <button type="submit" class="btn btn-primary" ng-click="edit_action_setting(action_item)">修改</button>
                                                            <button type="button" class="btn btn-default" data-dismiss="modal" ng-model="add_action_cancel_model" ng-click="reset_form(action_item)" id="action_edit_cancel_{{action_item.id}}">取消</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="btn-toolbar nlu-page">
                        <div class="btn-toolbar">
                            <div class="btn-group">
                                <button class="btn btn-default" ng-click="action_edit_goto_page(1);"><i class="icon-step-backward"></i> 首页</button>
                                <button class="btn btn-default" ng-click="action_edit_goto_page(action_edit_setting.cur_page- 1);"><i class="icon-chevron-left"></i> 上一页</button>
                                <button class="btn btn-primary">{{action_edit_setting.cur_page}}</button>
                                <button class="btn btn-default" ng-click="action_edit_goto_page(action_edit_setting.cur_page + 1);">下一页 <i class="icon-chevron-right"></i></button>
                                <button class="btn btn-default" ng-click="action_edit_goto_page(action_edit_setting.total_page);">末页 <i class="icon-step-forward"></i></button>
                                <button class="btn btn-default disabled">共({{action_edit_setting.total_num}}项，共{{action_edit_setting.total_page}}页)</button>
                                <div class="input-group input-group col-md-2">
                                    <input type="text" class="form-control" id="model_list_goto_page" value="{{goto_some_page}}" placeholder="跳转页" ng-model="goto_some_page">
                                    <span class="input-group-btn">
                                                            <button class="btn btn-default" type="button" ng-click="action_edit_goto_page(goto_some_page);" ><span class="glyphicon glyphicon-search" ></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /col-md-offset-1 col-md-10 -->
                </div>
                <button class="btn btn-primary add-intent" data-toggle="modal" data-target="#myModalAddAction">新增动作</button>
                <!-- add action Modal -->
                <div class="modal fade" id="myModalAddAction" tabindex="-1" role="dialog" aria-labelledby="myModalLabelAddAction" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <h4 class="modal-title" id="myModalLabelAddAction">新增动作</h4>
                            </div>
                            <div class="modal-body">
                                <br>
                                <form class="form-horizontal" role="form" id="edit_action_form_new">
                                    <div class="form-group">
                                        <label for="query" class="col-sm-3 control-label">动作名(action name)</label>
                                        <div class="col-sm-9">
                                            <input  type="text" id="input_action_name_new" class="form-control" value="" name="" placeholder="">
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="form-group">
                                   <!--  <label class="col-sm-12 text-center" >以下为二选一</label> -->
                                    </div>
                                    <div class="form-group">
                                        <label for="query" class="col-sm-3 control-label">执行(exe)</label>
                                        <input  id="action_new_exe_radio" ng-click="radio_change_new('exe')" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label" >
                                        <div class="col-sm-7">
                                            <input type="text" id="input_exe_new" class="form-control" value="" name="" placeholder="_或者字符开头，只能包含_、字母和数字">
                                        </div>
                                    </div>
                                     <div style="margin-left: 23%;margin-top: -14px;color: red">
                                    <label>(或者)</label>
                                    </div>

                                    <div class="form-group">
                                        <label for="query" class="col-sm-3 control-label">话术(say)</label>
                                        <input id="action_new_say_radio" style="margin-top: 9px" type="radio" name="" class="col-sm-1 control-label"  ng-click="radio_change_new('say')">
                                        <div class="col-sm-7">
                                            <textarea id="input_say_new" class="form-control" value="" name="" placeholder=""></textarea> 
                                        </div>
                                    </div>
                                    <div id = "slots_div_new" style="display: none;" class="form-group" ng-show="slot_list.length !=0">
                                    <label for="query" class="col-sm-3 control-label"><span >插</span><span style="color: transparent;" >对齐</span>入<br>槽位词典</label>
                                        <div  class="col-sm-7 col-sm-offset-1">
                                        <button  ng-repeat="slot in action_slot_list" ng-click="add_slot('input_say_new',slot.slot_name)" style="margin-top: 2%; margin-right: 3px;float: left;" class="btn btn-xs btn-default " class="btn-xs">{{slot.slot_name}}</button>


                                        </div>
                                    </div>
                                    <hr>
                                    <div class="form-group">
                                        <label for="intent" class="col-sm-3 control-label">动作类型(act_type)</label>
                                        <div class="col-sm-9">
                                            <select id="select_action_type_new" class="form-control" placeholder="" name="func_slot">
                                                <option ng-repeat="action_type in action_edit_drop_list.act_type" value="{{action_type}}">{{action_type}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                      <button   disabled="" id = "zhedie_button" style="float:left;" class="btn btn-default btn-xs " data-toggle="collapse"
        data-target="#demo">
        高级选项（待开放）
        </button>
        <br>
        <br>

                                    <div id="demo" class="collapse">
                                    <div class="form-group">
                                        <label for="intent" class="col-sm-3 control-label">目标(act_target)</label>
                                        <div class="col-sm-9">
                                            <select id="select_action_target_new" class="form-control" name="func_slot" ng-model="model_select_action_target" ng-change="action_new_change()">
                                                <option ng-repeat="action_target in action_edit_drop_list.act_target" value="{{action_target}}">{{action_target}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="intent" class="col-sm-3 control-label">类型细节(act type detail)</label>
                                        <div class="col-sm-9">
                                            <select  id="select_action_type_detail_new" class="form-control" placeholder="" name="func_slot">
                                                <option ng-repeat="action_type_detail in action_edit_drop_list.act_type_detail" value="{{action_type_detail}}"> {{action_type_detail}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>


                                    <div style="display:''" class="form-group" id="drop_list_div_new">
                                        <label for="intent" class="col-sm-3 control-label">目标细节(act target detail)</label>
                                        <div class="col-sm-9">
                                            <select id="select_action_target_detail_new" class="form-control" placeholder="" name="func_slot">
                                                <option ng-repeat="action_target_detail in action_edit_drop_list.act_target_detail" value="{{action_target_detail}}">{{action_target_detail}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    </div>
                      <!--                      <div disabled="true" style="display:none" class="form-group" id="check_box_div_new">
                                        <label for="intent" class="col-sm-3 control-label">目标细节(act target detail)</label>
                                        <div class="col-sm-9">
                                            <select id="select_action_target_detail_slot_new" class="form-control" placeholder="" name="func_slot">
                                                <option ng-repeat="action_target_detail in action_edit_drop_list.slot_list" value="{{action_target_detail.slot_name}}">{{action_target_detail.slot_name}}
                                                </option>
                                            </select>
                                        </div>
                                    </div> -->
                                 <!--    <div style="display:none" class="form-group" id="check_box_div_new">
                                        <label for="intent" class="col-sm-3 control-label">act target detail</label>
                                        <label ng-repeat=" action_target_detail in action_edit_drop_list.slot_list">
                                            <input style="margin-left: 10px" type="checkbox" id="check_box_action_target_detail_new_{{action_target_detail.slot_name}}" ng-model="role_action"> {{action_target_detail.slot_name}}
                                        </label>
                                    </div> -->
                                    <!-- <div class="form-group">
                                        <label for="intent" class="col-sm-3 control-label">下个动作</label>
                                        <div class="col-sm-9">
                                            <table class="table table-bordered query-slot-table" id="slot_table_add">
                                                <thead>
                                                    <tr>
                                                        <th>return code</th>
                                                        <th> 下一个action</th>
                                                        <th>删除</th>

                                                    </tr>
                                                </thead>
                                                <tbody id="tbody_next_action_new">
                                                    <tr class="query-slot-tr copyTr" id="copyTr_new" style="display: none;">
                                                        <td>
                                                            <input type="text" i class="form-control" value="" name="" placeholder="输入return code">
                                                        </td>
                                                        <td>
                                                            <select class="form-control" placeholder="" name="func_slot">
                                                                <option ng-repeat="next_action in action_edit_drop_list.action_list" value="{{next_action.id}}&_{{next_action.action_name}}">{{next_action.action_name}}
                                                                </option>
                                                            </select>
                                                        </td>

                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" onclick="action_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>删除
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div> -->
                                   <!--  <div>
                                        <span ng-model="add_next_action" ng-click="add_action_return_code_new()" style="color:#00FF004;width: 20px;height: 20px;margin-left: 50% ;" class="glyphicon glyphicon-plus"></span>
                                    </div> -->
                                </form>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" ng-click="add_action()">新增</button>
                                    <button type="reset" ng-click="reset_form_new()" class="btn btn-default" data-dismiss="modal" id="add_action_cancel">取消</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end modal -->
            </div>
        </div>
        <!-- /row -->
        <hr>
        <div class="row">
            <div class="col-md-offset-1 col-md-10 nlu-appmodel-table">
                <div ng-show="!trigger.trigger_list.length">
                    <div class="alert alert-warning alert-dismissible fade in" role="alert">
                        <button type="button" class="close" data-dismiss="alert" id="trigger_add_close_btn_{{tl.id}}"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                        该app下暂无动作规则，请先进行添加。
                    </div>
                    <a href="" class="btn btn-success add-intent" data-toggle="modal" data-target="#myModalAddTrigger">新增规则</a>
                </div>
                <div ng-show="trigger.trigger_list.length">
                    <h4 class="">触发规则 (TRIGGER)&nbsp;<span style="font-size: 20px;vertical-align: middle;color: #1ba8ed;" onMouseOver="$(this).tooltip('show')" id="hint_action_trigger" data-toggle="tooltip" data-placement="right"  title="在什么样的(意图&槽位)条件下，触发这个操作"><icon class="glyphicon glyphicon-question-sign"></icon></span></h4>
                    <table class="table table-condensed table-bordered table-hover">
                        <thead>
                            <th>优先级调整<br>
                            勾选需要调整的规则<br>
                            shift+w上移，shift+s下移</th>
                            <th>规则</th>
                            <th>触发动作</th>
                      <!--       <th>用户描述</th> -->
                            <!-- <th></th> -->
                            <th>操作</th>
                        </thead>
                        <tbody>
                            <tr ng-repeat="tl in trigger.trigger_list">
                                <td ng-if="trigger.cur_radio && tl.id == trigger.cur_radio"><input checked="true" id="{{tl.id}}_{{$index}}" type="radio" name="priority_choose"  value="{{tl.id}}">
                                <span class="glyphicon glyphicon-arrow-up"  ng-click="move_trigger(tl.id, 'up',$index)"></span>
                                <span class="glyphicon glyphicon-arrow-down"   ng-click="move_trigger(tl.id, 'down',$index)"></span>
                                </td>
                                <td ng-if="trigger.cur_radio == undefined || tl.id != trigger.cur_radio"><input  id="{{tl.id}}_{{$index}}" type="radio" name="priority_choose" value="{{tl.id}}" ng-click="radio_click(tl.id)">
                                    <span class="glyphicon glyphicon-arrow-up" ng-click="move_trigger(tl.id, 'up',$index)"></span>
                                <span class="glyphicon glyphicon-arrow-down" ng-click="move_trigger(tl.id, 'down',$index)"></span>
                                </td>
                                <td  style="width: 40%; text-align:left">{{tl.name}}</td>
                                <td style="text-align:left">{{tl.action_id}}</td>
                      <!--           <td style="text-align:left">{{tl.description}}</td> -->
                         
                                <td>
                                    <span class="glyphicon glyphicon-edit" title="编辑" data-toggle="modal" data-target="#myModalEditTrigger_{{tl.id}}" ng-click="trigger_edit_func(tl.id, 'trigger_tbody_edit_');radio_click(tl.id)"></span>
                                    <span class="glyphicon glyphicon-trash" style="margin-left: 30px" title="删除" ng-click="trigger_del(tl.id)"></span>
                                    <!-- edit Modal -->
                                    <div class="modal fade" id="myModalEditTrigger_{{tl.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabelTriggerEdit" aria-hidden="true">
                                        <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                                    <h4 class="modal-title" id="myModalLabelTriggerEdit">修改规则</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <br>
                                                    <form class="form-horizontal" role="form" id="edit_trigger_form_{{tl.id}}">
                                                        <div class="form-group">
                                                            <label for="query" class="col-sm-2 control-label">规则名称</label>
                                                            <div class="col-sm-10">
                                                                <input type="text" class="form-control" id="trigger_name_{{tl.id}}" value="{{tl.name}}" placeholder="只能输入A-Z a-z 0-9以及_" readonly="true">
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="query" class="col-sm-2 control-label">用户描述</label>
                                                            <div class="col-sm-10">
                                                                <input type="text" class="form-control" id="trigger_description_{{tl.id}}" value="{{tl.description}}" placeholder="" >
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="intent" class="col-sm-2 control-label">触发动作</label>
                                                            <div class="col-sm-10">
                                                                <select id="trigger_action_id_{{tl.id}}" class="form-control" placeholder="" name="trigger_action_name">
                                                                    <option ng-repeat="ta in trigger.action_list" value="{{ta.action_name}}:{{ta.id}}" ng-if="ta.action_name==tl.action_id" selected="true">{{ta.action_name}}</option>
                                                                    <option ng-repeat="ta in trigger.action_list" value="{{ta.action_name}}:{{ta.id}}" ng-if="ta.action_name!=tl.action_id">{{ta.action_name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="intent" class="col-sm-2 control-label">条件设置</label>
                                                            <div class="col-sm-10">
                                                                <table class="table table-bordered query-slot-table" id="trigger_table_{{tl.id}}">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>类别</th>
                                                                            <th>操作</th>
                                                                            <th>具体参数</th>
                                                                            <th></th>
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="trigger_tbody_edit_{{tl.id}}">
                                                                        <tr class="trigger_copy_tr copyTr" name="intent" style="display:none;">
                                                                            <td>
                                                                                <select id="trigger_todo" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_todo_change(this);">
                                                                                    <option value="intent">用户意图</option>
                                                                                    <option value="quslot">当前query中</option>
                                                                                    <option value="sessionslot">当前会话中</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_intent_equal">
                                                                                    <option value="==">等于</option>
                                                                                    <option value="!=">不等于</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_intent_intent">
                                                                                    <option ng-repeat="ti in trigger.intent_list" value="{{ti.intent_name}}:{{ti.func_slot}}">{{ti.intent_name}}</option>
                                                                                </select>
                                                                            </td>
                                                                            <td><span>&nbsp;</span></td>
                                                                            <td>
                                                                                <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="trigger_copy_tr copyTr" name="quslot" style="display:none;">
                                                                            <td>
                                                                                <select id="trigger_todo" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_todo_change(this);">
                                                                                    <option value="quslot">当前query中</option>
                                                                                    <option value="intent">用户意图</option>
                                                                                    <option value="sessionslot">当前会话中</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_quslot_equal" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_contain_fill_change(this);">
                                                                                    <option value="contain">包含了</option>
                                                                                    <option value="not_contain">没有包含</option>
                                                                                    <option value="true">已填充</option>
                                                                                    <option value="false">未填充</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_quslot_slot">
                                                                                    <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                中的<input type="text" name="trigger_quslot_tag" value="" style="width:80%">
                                                                            </td>
                                                                            <td>
                                                                                <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="trigger_copy_tr copyTr" name="quslotfill" style="display:none;">
                                                                            <td>
                                                                                <select id="trigger_todo" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_todo_change(this);">
                                                                                    <option value="quslot">当前query中</option>
                                                                                    <option value="intent">用户意图</option>
                                                                                    <option value="sessionslot">当前会话中</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_quslot_fill" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_contain_fill_change(this);">
                                                                                    <option value="true">已填充</option>
                                                                                    <option value="false">未填充</option>
                                                                                    <option value="contain">包含</option>
                                                                                    <option value="not_contain">不包含</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_quslot_slot">
                                                                                    <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                                                </select>
                                                                            </td>
                                                                            <td><span>&nbsp;</span></td>
                                                                            <td>
                                                                                <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="trigger_copy_tr copyTr" name="sessionslot" style="display:none;">
                                                                            <td>
                                                                                <select id="trigger_todo" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_todo_change(this);">
                                                                                    <option value="sessionslot">当前会话中</option>
                                                                                    <option value="quslot">当前query中</option>
                                                                                    <option value="intent">用户意图</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_sessionslot_equal" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_contain_fill_change(this);">
                                                                                    <option value="contain">包含了</option>
                                                                                    <option value="not_contain">没有包含</option>
                                                                                    <option value="true">已填充</option>
                                                                                    <option value="false">未填充</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_sessionslot_slot">
                                                                                    <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                中的<input type="text" name="trigger_sessionslot_tag" value="" style="width:80%">
                                                                            </td>
                                                                            <td>
                                                                                <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="trigger_copy_tr copyTr" name="sessionslotfill" style="display:none;">
                                                                            <td>
                                                                                <select id="trigger_todo_{{ti.id}}" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_todo_change(this);">
                                                                                    <option value="sessionslot">当前会话中</option>
                                                                                    <option value="quslot">当前query中</option>
                                                                                    <option value="intent">用户意图</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_sessionslot_fill" tbodyname="trigger_tbody_edit_{{tl.id}}" onchange="trigger_contain_fill_change(this);">
                                                                                    <option value="true">已填充</option>
                                                                                    <option value="false">未填充</option>
                                                                                    <option value="contain">包含</option>
                                                                                    <option value="not_contain">不包含</option>
                                                                                </select>
                                                                            </td>
                                                                            <td>
                                                                                <select name="trigger_sessionslot_slot">
                                                                                    <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                                                </select>
                                                                            </td>
                                                                            <td><span>&nbsp;</span></td>
                                                                            <td>
                                                                                <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-sm-offset-10">
                                                                <button class="btn btn-warning" id="intertTriggerCondition_{{tl.id}}" tbodyname="trigger_tbody_edit_{{tl.id}}" onclick="trigger_add_condition('intent', this)">新增条件</button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <div class="modal-footer">
                                                        <button type="submit" class="btn btn-primary" tlid="{{tl.id}}" triggernameid="trigger_name_{{tl.id}}" triggeractionid="trigger_action_id_{{tl.id}}" triggertbodyid="trigger_tbody_edit_{{tl.id}}" ng-click="trigger_add('trigger_name_'+tl.id, 'trigger_description_' + tl.id,'trigger_action_id_'+tl.id, 'trigger_tbody_edit_'+tl.id, 'edit_trigger_form_'+tl.id, 'trigger_add_cancel_'+tl.id, tl.id, 'trigger_add_close_btn_'+tl.id, 'edit');">保存</button>
                                                        <button type="button" class="btn btn-default" data-dismiss="modal" id="trigger_edit_cancel_{{tl.id}}" tbodyname="trigger_tbody_edit_{{tl.id}}" tformname="edit_trigger_form_{{tl.id}}" onclick="trigger_form_reset(this);">取消</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /Modal-->
                                </td>
                            </tr>
                        </tbody>
                    </table>
                  <!--   <button ng-click="trigger_effect()" >规则生效</button> -->





                    <a href="" class="btn btn-success add-intent" data-toggle="modal" data-target="#myModalAddTrigger">新增规则</a>
                    <!-- page -->
                    <div class="btn-toolbar nlu-page">
                        <div class="btn-toolbar">
                            <div class="btn-group">
                                <button class="btn btn-default" ng-click="get_trigger_list(1);"><i class="icon-step-backward"></i> 首页</button>
                                <button class="btn btn-default" ng-click="get_trigger_list(trigger.pre_page);"><i class="icon-chevron-left"></i> 上一页</button>
                                <button class="btn btn-primary">{{trigger.this_page}}</button>
                                <button class="btn btn-default" ng-click="get_trigger_list(trigger.next_page);">下一页 <i class="icon-chevron-right"></i></button>
                                <button class="btn btn-default" ng-click="get_trigger_list(trigger.pageall);">末页 <i class="icon-step-forward"></i></button>
                                <button class="btn btn-default disabled">共({{trigger.total}}项，共{{trigger.pageall}}页)</button>
                                <div class="input-group input-group col-md-2">
                                    <input type="text" class="form-control" id="trigger_list_goto_page" value="{{goto_trigger_page}}" placeholder="跳转页" ng-model="goto_trigger_page">
                                    <span class="input-group-btn">
                                            <button class="btn btn-default" type="button" ng-click="get_trigger_list(goto_trigger_page);" ><span class="glyphicon glyphicon-search" ></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- page -->
                </div>
                <!-- add Modal -->
                <div class="modal fade" id="myModalAddTrigger" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" id="trigger_add_close_btn"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <h4 class="modal-title" id="myModalLabel">新增规则</h4>
                            </div>
                            <div class="modal-body">
                                <br>
                                <form class="form-horizontal" role="form" id="add_trigger_form">
                                    <div class="form-group">
                                        <label for="query" class="col-sm-2 control-label">规则名称</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control" id="trigger_name" placeholder="只能输入A-Z a-z 0-9以及_">
                                        </div>
                                    </div>
                                     <div class="form-group">
                                        <label for="query" class="col-sm-2 control-label">用户描述</label>
                                        <div class="col-sm-10">
                                            <input type="text" class="form-control" id="trigger_description" placeholder="">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="intent" class="col-sm-2 control-label">触发动作</label>
                                        <div class="col-sm-10">
                                            <select id="trigger_action_id" class="form-control" placeholder="" name="trigger_action_name">
                                                <option ng-repeat="ta in trigger.action_list" value="{{ta.action_name}}:{{ta.id}}">{{ta.action_name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="intent" class="col-sm-2 control-label">条件设置</label>
                                        <div class="col-sm-10">
                                            <table class="table table-bordered query-slot-table" id="slot_table">
                                                <thead>
                                                    <tr>
                                                        <th>类别</th>
                                                        <th>操作</th>
                                                        <th>具体参数</th>
                                                        <th></th>
                                                        <th></th>
                                                    </tr>
                                                </thead>
                                                <tbody id="trigger_tbody">
                                                    <tr class="trigger_copy_tr copyTr" name="intent" style="display:none;">
                                                        <td>
                                                            <select id="trigger_todo" tbodyname="trigger_tbody" onchange="trigger_todo_change(this);">
                                                                <option value="intent">用户意图</option>
                                                                <option value="quslot">当前query中</option>
                                                                <option value="sessionslot">当前会话中</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_intent_equal">
                                                                <option value="==">等于</option>
                                                                <option value="!=">不等于</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_intent_intent">
                                                                <option ng-repeat="ti in trigger.intent_list" value="{{ti.intent_name}}:{{ti.func_slot}}">{{ti.intent_name}}</option>
                                                            </select>
                                                        </td>
                                                        <td><span>&nbsp;</span></td>
                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr class="trigger_copy_tr copyTr" name="quslot" style="display:none;">
                                                        <td>
                                                            <select id="trigger_todo" tbodyname="trigger_tbody" onchange="trigger_todo_change(this);">
                                                                <option value="quslot">当前query中</option>
                                                                <option value="intent">用户意图</option>
                                                                <option value="sessionslot">当前会话中</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_quslot_equal" tbodyname="trigger_tbody" onchange="trigger_contain_fill_change(this);">
                                                                <option value="contain">包含了</option>
                                                                <option value="not_contain">没有包含</option>
                                                                <option value="true">已填充</option>
                                                                <option value="false">未填充</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_quslot_slot">
                                                                <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            中的<input type="text" name="trigger_quslot_tag" value="" style="width:80%">
                                                        </td>
                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr class="trigger_copy_tr copyTr" name="quslotfill" style="display:none;">
                                                        <td>
                                                            <select id="trigger_todo" tbodyname="trigger_tbody" onchange="trigger_todo_change(this);">
                                                                <option value="quslot">当前query中</option>
                                                                <option value="intent">用户意图</option>
                                                                <option value="sessionslot">当前会话中</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_quslot_fill" tbodyname="trigger_tbody" onchange="trigger_contain_fill_change(this);">
                                                                <option value="true">已填充</option>
                                                                <option value="false">未填充</option>
                                                                <option value="contain">包含</option>
                                                                <option value="not_contain">不包含</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_quslot_slot">
                                                                <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                            </select>
                                                        </td>
                                                        <td><span>&nbsp;</span></td>
                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr class="trigger_copy_tr copyTr" name="sessionslot" style="display:none;">
                                                        <td>
                                                            <select id="trigger_todo" tbodyname="trigger_tbody" onchange="trigger_todo_change(this);">
                                                                <option value="sessionslot">当前会话中</option>
                                                                <option value="quslot">当前query中</option>
                                                                <option value="intent">用户意图</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_sessionslot_equal" tbodyname="trigger_tbody" onchange="trigger_contain_fill_change(this);">
                                                                <option value="contain">包含了</option>
                                                                <option value="not_contain">没有包含</option>
                                                                <option value="true">已填充</option>
                                                                <option value="false">未填充</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_sessionslot_slot">
                                                                <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            中的<input type="text" name="trigger_sessionslot_tag" value="" style="width:80%">
                                                        </td>
                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr class="trigger_copy_tr copyTr" name="sessionslotfill" style="display:none;">
                                                        <td>
                                                            <select id="trigger_todo" tbodyname="trigger_tbody" onchange="trigger_todo_change(this);">
                                                                <option value="sessionslot">当前会话中</option>
                                                                <option value="quslot">当前query中</option>
                                                                <option value="intent">用户意图</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_sessionslot_fill" tbodyname="trigger_tbody" onchange="trigger_contain_fill_change(this);">
                                                                <option value="true">已填充</option>
                                                                <option value="false">未填充</option>
                                                                <option value="contain">包含</option>
                                                                <option value="not_contain">不包含</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select name="trigger_sessionslot_slot">
                                                                <option ng-repeat="ti in trigger.slot_list" value="{{ti.slot_name}}">{{ti.slot_name}}</option>
                                                            </select>
                                                        </td>
                                                        <td><span>&nbsp;</span></td>
                                                        <td>
                                                            <button type="button" class="btn btn-danger btn-xs" class="triggerDel" onclick="trigger_todo_delete(this)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-10">
                                            <button class="btn btn-warning" id="intertTriggerCondition" tbodyname="trigger_tbody" onclick="trigger_add_condition('intent', this)">新增条件</button>
                                        </div>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary" tlid="0" triggernameid="trigger_name" triggeractionid="trigger_action_id" triggertbodyid="trigger_tbody"  ng-click="trigger_add('trigger_name','trigger_description','trigger_action_id', 'trigger_tbody', 'add_trigger_form', 'trigger_add_cancel', '0', 'trigger_add_close_btn', 'add');">保存</button>
                                    <button type="button" class="btn btn-default" data-dismiss="modal" id="trigger_add_cancel" tbodyname="trigger_tbody" tformname="add_trigger_form" onclick="trigger_form_reset(this);">取消</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Modal-->
            </div>
        </div>
    </div>
    <!-- /row -->
</div>
</div>
</div>
<script type="text/javascript">
function action_delete(obj) {
    jQuery(obj).parent().parent().remove();
}

function trigger_todo_delete(obj) {
    jQuery(obj).parent().parent().remove();
}

function trigger_copy_tr(which, id) {
    var tro = $("#" + id).children();
    console.log("tro :" + id);
    console.log(tro);
    tro.each(function(index, element) {
        var obj = jQuery(element);
        if (obj.attr("name") == which && obj.attr("class") =="trigger_copy_tr copyTr") {
            var e = obj.clone();
            $("#" + id).append("<tr name=" + which +">" + e.html() +"</tr>");
        }
    });
}

function trigger_clear_tr(id) {
    var tro = $("#" + id).children();
    tro.each(function(index, element) {
        if (index > 4) {
            jQuery(element).closest("tr").remove();
        }
    });
}

function trigger_tr_return(which, id) {
    var tro = $("#" + id).children();
    var st ="";
    var flag = 0;
    tro.each(function(index, element) {
        var obj = jQuery(element);
        if (obj.attr("name") == which && obj.attr("class") =="trigger_copy_tr copyTr" && flag == 0) {
            var e = obj.clone();
            st ="<tr name=" + which +">" + e.html() +"</tr>";
            flag = 1;
        }
    });
    return st;
}

function trigger_todo_change(obj) {
    //alert(jQuery(obj).val());
    this_obj = jQuery(obj).closest("tr");
    var copy_which = jQuery(obj).val();
    var id = jQuery(obj).attr("tbodyname");
    console.log("trigger_todo_change:" + id);
    var tro = $("#" + id).children();
    console.log(tro);
    tro.each(function(index, element) {
        var first = jQuery(element);
        if (index < 5 && first.attr("name") == copy_which) {
            //alert(trigger_tr_return(copy_which));
            this_obj.after(trigger_tr_return(copy_which, id));
            this_obj.remove();
        }
    });
}

function trigger_contain_fill_change(obj) {
    this_obj = jQuery(obj).closest("tr");
    var which = jQuery(obj).val();
    var copy_which ="";
    var id = jQuery(obj).attr("tbodyname");
    console.log("tbodyname:" + id);
    if (which =="contain" || which =="not_contain") {
        copy_which = this_obj.attr("name").split("fill")[0];
    } else if (which =="true" || which =="false") {
        copy_which = this_obj.attr("name").split("fill")[0] +"fill";
    }
    if (copy_which == this_obj.attr("name")) {
        return;
    }
    //alert(this_obj.attr("name") +"" + which +"" + copy_which);
    var tro = $("#" + id).children();
    var new_option;
    tro.each(function(index, element) {
        var first = jQuery(element);
        if (index < 5 && first.attr("name") == copy_which) {
            //alert(trigger_tr_return(copy_which));
            //console.log(trigger_tr_return(copy_which).replace('value="'+ copy_which+'"', 'value="'+ copy_which+'" selected="true"'));
            //console.log(trigger_tr_return(copy_which).replace('value="'+ which+'"', 'value="'+ which+'" selected="true"'));
            this_obj.before(trigger_tr_return(copy_which, id).replace('value="' + which + '"', 'value="' + which + '" selected="true"'));
            new_obj = this_obj.before();
            //console.log(this_obj.before().html());
            this_obj.remove();

            // new_obj.find("select").each(function(i, e){

            //     if(e.name =="trigger_sessionslot_fill" || e.name =="trigger_sessionslot_equal" ||
            //        e.name =="trigger_quslot_fill" || e.name =="trigger_quslot_equal")
            //     {
            //         //alert(e.name +"  " + which +"start --");
            //         //jQuery(e).find("option[value='"+which+"']").attr("selected",true);

            //         jQuery(e).children().each(function(j, ev){
            //             if (ev.value == which)
            //             {
            //                 jQuery(e).val(which);
            //                 //alert(jQuery(e).val());
            //                 //alert( ev.value +"which ==" + which);
            //                 return false;
            //             }
            //         });
            //     }

            // })
        }
        //alert("new" + jQuery(new_option).val());
    });

}

function trigger_add_condition(which, obj) {
    var id = jQuery(obj).attr("tbodyname");
    console.log("trigger_add_condition tbodyname:" + id);
    trigger_copy_tr(which, id);
}

function trigger_form_reset(obj) {
    var id = jQuery(obj).attr("tbodyname");
    var formid = jQuery(obj).attr("tformname");
    trigger_clear_tr(id);
    document.getElementById(formid).reset();
}

function trigger_form_reset_for_scope(id, formid, cancel_id) {
    //var id = jQuery(obj).attr("tbodyname");
    //var formid = jQuery(obj).attr("tformname");
    trigger_clear_tr(id);
    document.getElementById(formid).reset();
    document.getElementById(cancel_id).click();
}

$(document).ready(function(){
    $('#hint_action_list').tooltip('hide');
    $('#hint_action_trigger').tooltip('hide');
    $('#hint_save_info').tooltip('hide');
    $("#bot_merge_rule_div").bind("keydown",function(e){
            // 兼容FF和IE和Opera
            var theEvent = e || window.event;
            var code = theEvent.keyCode || theEvent.which || theEvent.charCode;

            if (code == 13) {
                //回车执行查询
                    console.log("bot_session_update_set_btn");
                    $("#bot_session_update_set_btn").click();
                }
        });
});
</script>
